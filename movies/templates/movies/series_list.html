{% extends 'movies/base.html' %}

{% block content %}
<div class="container mx-auto px-4 py-8">
    <!-- Header -->
    <div class="mb-8">
        <h1 class="text-3xl font-bold text-gray-800 dark:text-white">TV Series</h1>
        <p class="text-gray-600 dark:text-gray-300 mt-2">Discover the latest and greatest TV series</p>
    </div>

    <!-- Filters -->
    <div class="mb-6 flex flex-wrap gap-4">
        <select id="genreFilter" class="bg-white dark:bg-gray-800 border border-gray-300 dark:border-gray-700 rounded-lg px-4 py-2">
            <option value="">All Genres</option>
            {% for genre in genres %}
            <option value="{{ genre.id }}">{{ genre.name }}</option>
            {% endfor %}
        </select>

        <select id="yearFilter" class="bg-white dark:bg-gray-800 border border-gray-300 dark:border-gray-700 rounded-lg px-4 py-2">
            <option value="">All Years</option>
            {% for year in years %}
            <option value="{{ year }}">{{ year }}</option>
            {% endfor %}
        </select>
    </div>

    <!-- Series Grid -->
    <div class="grid grid-cols-1 sm:grid-cols-2 md:grid-cols-3 lg:grid-cols-4 gap-6">
        {% for series in series_list %}
        <div class="bg-white dark:bg-gray-900 rounded-lg shadow-lg overflow-hidden hover:shadow-xl transition-shadow duration-300">
            <a href="{{ series.get_absolute_url }}">
                <img src="{{ series.thumbnail_url }}" 
                     alt="{{ series.title }}" 
                     class="w-full h-48 object-cover">
                
                <div class="p-4">
                    <h2 class="text-lg font-semibold text-gray-800 dark:text-white">{{ series.title }}</h2>
                    
                    <div class="flex flex-wrap gap-2 mt-2">
                        {% for genre in series.genres.all %}
                        <span class="text-xs bg-primary-light/10 dark:bg-primary-dark/10 text-primary-light dark:text-primary-dark px-2 py-1 rounded-full">
                            {{ genre.name }}
                        </span>
                        {% endfor %}
                    </div>
                    
                    <div class="mt-3 text-sm text-gray-600 dark:text-gray-400">
                        <span>{{ series.release_year }}</span>
                        {% if series.seasons.count %}
                        <span class="mx-2">â€¢</span>
                        <span>{{ series.seasons.count }} Season{{ series.seasons.count|pluralize }}</span>
                        {% endif %}
                    </div>
                </div>
            </a>
        </div>
        {% endfor %}
    </div>

    <!-- Pagination -->
    {% if is_paginated %}
    <div class="mt-8 flex justify-center">
        <div class="flex space-x-2">
            {% if page_obj.has_previous %}
            <a href="?page={{ page_obj.previous_page_number }}" 
               class="px-4 py-2 bg-gray-200 dark:bg-gray-700 rounded-lg">
                Previous
            </a>
            {% endif %}
            
            {% if page_obj.has_next %}
            <a href="?page={{ page_obj.next_page_number }}" 
               class="px-4 py-2 bg-gray-200 dark:bg-gray-700 rounded-lg">
                Next
            </a>
            {% endif %}
        </div>
    </div>
    {% endif %}
</div>

<script>
    document.addEventListener('DOMContentLoaded', function() {
    const genreFilter = document.getElementById('genreFilter');
    const yearFilter = document.getElementById('yearFilter');

    function updateFilters() {
        const genre = genreFilter.value;
        const year = yearFilter.value;
        
        let url = new URL(window.location);
        if (genre) url.searchParams.set('genre', genre);
        else url.searchParams.delete('genre');
        if (year) url.searchParams.set('year', year);
        else url.searchParams.delete('year');
        
        window.location = url;
    }

    genreFilter.addEventListener('change', updateFilters);
    yearFilter.addEventListener('change', updateFilters);
});

</script>
{% endblock %}
